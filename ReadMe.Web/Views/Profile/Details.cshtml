@using Microsoft.AspNet.Identity;
@using ReadMe.Web.Models.Profile;

@model ReadMe.Web.Models.Profile.ProfileViewModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@if(@Model.UserDetailsViewModel.Id == User.Identity.GetUserId())
{
    <h2 class="title">My profile</h2>
}
else
{
    <h2 class="title">Profile</h2>
}

<div>
    <hr />
    <div class="row">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="col-md-4 col-xs-12 col-sm-6 col-lg-4">
                        <img alt="User Pic" src="@Model.UserDetailsViewModel.PhotoUrl" id="profile-image1" class="img-thumbnail img-responsive">
                    </div>
                    <div class="col-md-8 col-xs-12 col-sm-6 col-lg-8">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-10">
                                    <h2>@Model.UserDetailsViewModel.UserName</h2>
                                </div>
                                <div class="col-md-2">
                                    @if (@Model.UserDetailsViewModel.Id == User.Identity.GetUserId())
                                    {
                                        <h3>
                                            <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#edit-form-modal">
                                                <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                                Edit
                                            </button>
                                        </h3>
                                    }
                                    else
                                    {
                                        <h3>
                                            @Html.ActionLink("Follow", "Edit", "Profile", routeValues: null, htmlAttributes: new { @class = "btn btn-warning btn-lg" })
                                        </h3>
                                    }

                                </div>
                            </div>
                            <p>
                                <i class="fa fa-envelope one" style="width:50px;"></i>
                                @Model.UserDetailsViewModel.Email
                            </p>
                        </div>
                        <hr>
                        <dl class="container details dl-horizontal">
                            <dt>
                                @Html.DisplayNameFor(model => model.UserDetailsViewModel.FullName)
                            </dt>

                            <dd>
                                @Html.DisplayFor(model => model.UserDetailsViewModel.FullName)
                            </dd>

                            <dt>
                                @Html.DisplayNameFor(model => model.UserDetailsViewModel.Nationality)
                            </dt>

                            <dd>
                                @if (Model.UserDetailsViewModel.Nationality != null)
                                {
                                    @Html.DisplayFor(model => model.UserDetailsViewModel.Nationality)

                                }
                                else
                                {
                                    <span>-</span>
                                }
                            </dd>

                            <dt>
                                @Html.DisplayNameFor(model => model.UserDetailsViewModel.Age)
                            </dt>

                            <dd>
                                @if (Model.UserDetailsViewModel.Age != 0)
                                {
                                    @Html.DisplayFor(model => model.UserDetailsViewModel.Age)
                                }
                                else
                                {
                                    <span>-</span>
                                }
                            </dd>

                            <dt>
                                @Html.DisplayNameFor(model => model.UserDetailsViewModel.FavouriteQuote)
                            </dt>

                            <dd>
                                @if (Model.UserDetailsViewModel.FavouriteQuote != null)
                                {
                                    @Html.DisplayFor(model => model.UserDetailsViewModel.FavouriteQuote)
                                }
                                else
                                {
                                    <span>-</span>
                                }
                            </dd>
                        </dl>
                    </div>
                </div>
            </div>
        </div>

    <div class="container">
        <h2>
            <b>Books</b>
        </h2>
        <hr />
        <div class="profile-wishlist">
            <h3>
                <b>Want To Read</b>
            </h3>
            <hr />
            @foreach (var book in Model.WishlistBooks)
            {
                @Html.Partial("_BooksPartial", book)
            }

            @if (!Model.WishlistBooks.Any())
            {
                <p>No books added with this status</p>
            }
        </div>
        <hr />
        <div class="profile-currently-reading">
            <h3>
                <b>Currently Reading</b>
            </h3>
            <hr />
            @foreach (var book in Model.CurrentlyReadingBooks)
            {
                @Html.Partial("_BooksPartial", book)
            }

            @if (!Model.CurrentlyReadingBooks.Any())
            {
                <p>No books added with this status</p>
            }
        </div>
    </div>

    <div class="modal fade" id="edit-form-modal" tabindex="-1" role="dialog" aria-labelledby="edit-form-modal" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="exampleModalLabel">Edit user</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                @using (Ajax.BeginForm("Edit", "Profile", null, new AjaxOptions
                {
                    InsertionMode = InsertionMode.Replace,
                    HttpMethod = "POST"
                }))
                {
                <div class="modal-body">
                    ...
                    @Html.AntiForgeryToken()
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <input type="submit" value="Save changes" class="btn btn-primary" id="send" />
                </div>
                }
            </div>
        </div>
    </div>

</div>
